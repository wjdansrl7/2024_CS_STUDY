# Proxy Pattern

- í”„ë¡ì‹œ íŒ¨í„´ì€ **ì›ë³¸ ê°ì²´ë¥¼ ëŒ€ë¦¬í•˜ì—¬ ëŒ€ì‹  ì²˜ë¦¬í•˜ê²Œ í•¨ìœ¼ë¡œì¨ ë¡œì§ì˜ íë¦„ì„ ì œì–´**í•˜ëŠ” í–‰ë™ íŒ¨í„´ì´ë‹¤.

- í´ë¼ì´ì–¸íŠ¸ê°€ ëŒ€ìƒ ê°ì²´ë¥¼ ì§ì ‘ ì“°ëŠ” ê²Œ ì•„ë‹ˆë¼ ì¤‘ê°„ì— í”„ë¡ì‹œë¥¼ ê±°ì³ì„œ ì“°ëŠ” ì½”ë“œ íŒ¨í„´

- ë²ˆê±°ëŸ½ê²Œ í”„ë¡ì‹œë¥¼ ì´ìš©í•˜ëŠ” ì´ìœ ëŠ”, ëŒ€ìƒ í´ë˜ìŠ¤ê°€ **ë¯¼ê°í•œ ì •ë³´**ë¥¼ ê°€ì§€ê³  ìˆê±°ë‚˜ **ì¸ìŠ¤í„´ìŠ¤í™” í•˜ê¸°ì— ë¬´ê²**ê±°ë‚˜ **ì¶”ê°€ ê¸°ëŠ¥ì„ ê°€ë¯¸**í•˜ê³  ì‹¶ì€ë°, **ì›ë³¸ ê°ì²´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ëŠ” ìƒí™©**ì¼ ë•Œë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ì„œë‹¤.

## Proxy patternì˜ ëª©ì 

1. ë³´ì•ˆ : í”„ë¡ì‹œëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ìˆëŠ” ì§€ë¥¼ í™•ì¸í•˜ê³  ìš”ì²­ì„ ëŒ€ìƒì—ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.
2. ìºì‹± : í”„ë¡ì‹œê°€ ë‚´ë¶€ ìºì‹œë¥¼ ìœ ì§€í•˜ì—¬ ë°ì´í„°ê°€ ìºì‹œì— ì•„ì§ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—ë§Œ ëŒ€ìƒì—ì„œ ì‘ì—…ì´ ì‹¤í–‰ë˜ë„ë¡ í•œë‹¤.
3. ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ : í”„ë¡ì‹œê°€ ì…ë ¥ì„ ëŒ€ìƒìœ¼ë¡œ ì „ë‹¬í•˜ê¸° ì „ì— ìœ íš¨ì„±ì„ ê²€ì‚¬í•œë‹¤.
4. ì§€ì—° ì´ˆê¸°í™” : ëŒ€ìƒì˜ ìƒì„± ë¹„ìš©ì´ ë¹„ì‹¸ë‹¤ë©´ í”„ë¡ì‹œëŠ” ê·¸ê²ƒì„ í•„ìš”ë¡œ í•  ë•Œê¹Œì§€ ì—°ê¸°í•  ìˆ˜ ìˆë‹¤.
5. ë¡œê¹… : í”„ë¡ì‹œëŠ” ë©”ì†Œë“œ í˜¸ì¶œê³¼ ìƒëŒ€ ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì¸í„°ì…‰íŠ¸í•˜ê³  ì´ë¥¼ ê¸°ë¡í•œë‹¤.
6. ì›ê²© ê°ì²´ : í”„ë¡ì‹œëŠ” ì›ê²© ìœ„ì¹˜ì— ìˆëŠ” ê°ì²´ë¥¼ ê°€ì ¸ì™€ì„œ ë¡œì»¬ì²˜ëŸ¼ ë³´ì´ê²Œ í•  ìˆ˜ ìˆë‹¤.

## Proxy Pattern êµ¬ì¡°

![í”„ë¡ì‹œíŒ¨í„´ êµ¬ì¡°](/DesignPattern/images/Proxy.png)

1. Subject : Proxyì™€ RealSubjectë¥¼ í•˜ë‚˜ë¡œ ë¬¶ëŠ” ì¸í„°í˜ì´ìŠ¤
    - ëŒ€ìƒ ê°ì²´ì™€ í”„ë¡ì‹œ ì—­í• ì„ ë™ì¼í•˜ê²Œ í•˜ëŠ” ì¶”ìƒ ë©”ì„œë“œë¥¼ ì •ì˜í•œë‹¤ . `operation()`
    - ì¸í„°í˜ì´ìŠ¤ë¡œ ì¸í•´ í´ë¼ì´ì–¸íŠ¸ëŠ” Proxyê³¼ realSubject ì—­í• ì˜ ì°¨ì´ë¥¼ ì˜ì‹í•  í•„ìš”ê°€ ì—†ë‹¤.

2. RealSubject : ì›ë³¸ ëŒ€ìƒ ê°ì²´
3. Proxy : realSubjectë¥¼ ì¤‘ê³„í•  ëŒ€ë¦¬ì ì—­í• 
    - í”„ë¡ì‹œëŠ” ëŒ€ìƒ ê°ì²´ë¥¼ í•©ì„±í•œë‹¤.
    - í”„ë¡ì‹œëŠ” ëŒ€ìƒ ê°ì²´ì™€ ê°™ì€ ì´ë¦„ì˜ ë©”ì†Œë“œë¥¼ í˜¸ì¶”ë¼ë©°, ë³„ë„ì˜ ë¡œì§ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. 
    - í”„ë¡ì‹œëŠ” íë¦„ì œì–´í•  ë¿ ê²°ê³¼ê°’ì„ ì¡°ì‘í•˜ê±°ë‚˜ ë³€ê²½í•´ì„œëŠ” ì•ˆëœë‹¤.
4. Client : Subject ì¸í„°í˜ì´ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•´ ì´ìš©.
    - í´ë¼ì´ì–¸íŠ¸ëŠ” í”„ë¡ì‹œë¥¼ ì¤‘ê°„ì— ë‘ê³  í”„ë¡ì‹œë¥¼ í†µí•´ RealSubjectì™€ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ëŠ”ë‹¤.

## Proxy Pattern ì¢…ë¥˜

1. ê¸°ë³¸í˜• í”„ë¡ì‹œ

```java
Interface ISubject {
    void action();
}

class RealSubject implements ISubject {
    public void action() {
        System.out.println("ì›ë³¸ ê°ì²´!!");
    }
}

class Proxy implements ISubject {

    private ISubject subject;

    Proxy(ISubject subject) {
        this.subject = subject;
    }

    public void action() {
        subject.action();
        System.out.println("í”„ë¡ì‹œ ê°ì²´!!");
    }
}

class Client {
    public static void main(String[] args) {
        ISubject sub = new Proxy(new RealSubject());
        sub.action();
    }
}

// ì›ë³¸ ê°ì²´!!
// í”„ë¡ì‹œ ê°ì²´!!

```


> ê¸°ë³¸í˜• í”„ë¡ì‹œë¥¼ ì–´ë–¤ì‹ìœ¼ë¡œ ë³€í˜•í•˜ëŠëƒì— ë”°ë¼ í”„ë¡ì‹œ ì¢…ë¥˜ê°€ ë‚˜ëˆ„ì–´ ì§„ë‹¤.

2. ê°€ìƒ í”„ë¡ì‹œ
- ì§€ì—° ì´ˆê¸°í™” ë°©ì‹
- ì´ êµ¬í˜„ì€ ì‹¤ì œ ê°ì²´ì˜ ìƒì„±ì— ë§ì€ ìì›ì´ ì†Œëª¨ ë˜ì§€ë§Œ ì‚¬ìš© ë¹ˆë„ëŠ” ë‚®ì„ ë•Œ ì“°ëŠ” ë°©ì‹ì´ë‹¤.
- ì„œë¹„ìŠ¤ê°€ ì‹œì‘ë  ë•Œ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ëŒ€ì‹ ì— ê°ì²´ ì´ˆê¸°í™”ê°€ ì‹¤ì œë¡œ í•„ìš”í•œ ì‹œì ì— ì´ˆê¸°í™”ë ìˆ˜ ìˆë„ë¡ ì§€ì—°í•  ìˆ˜ ìˆë‹¤.


```java
class Proxy implements ISubject {

    private ISubject subject;

    Proxy() { }

    public void action() {
        if(subject == null) subject = new RealSubject();
        subject.action();
    }

}

```

> ê¸°ë³¸í˜•ê³¼ ë‹¬ë¦¬ ìƒì„±ìì—ì„œ RealSubjectì£¼ì…í•˜ì§€ ì•Šê³  ì‹¤ì œ actionì—ì„œ ì£¼ì… ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³  ì£¼ì…í•œë‹¤. => ì‚¬ìš©ë˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤ë©´ ê°€ìƒ í”„ë¡ì‹œ ë°©ì‹ì´ ë” íš¨ìœ¨ì ì¼ ê²ƒì´ë‹¤.


3. ë³´í˜¸ í”„ë¡ì‹œ
- í”„ë¡ì‹œê°€ ëŒ€ìƒ ê°ì²´ì— ëŒ€í•œ ìì›ìœ¼ë¡œì˜ ì—‘ì„¸ìŠ¤ë¥¼ ì œì–´í•œë‹¤.
- í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì˜ ìê²© ì¦ëª…ì´ ê¸°ì¤‘ê³¼ ì¼ì¹˜í•˜ëŠ” ê²½ìš°ì—ë§Œ ì„œë¹„ìŠ¤ ê°ì²´ì— ìš”ì²­ì„ ì „ë‹¬í•  ìˆ˜ ìˆê²Œ í•œë‹¤.


```java
class Proxy implements ISubject {
    private RealSubject subject;
    boolean access;

    Proxy(RealSubject subject, boolean access) {
        this.subject = subject;
        this.access = access;
    }

    public void action() {
        if(access) {
            subject.action();
        }
    }
}

```

4. ë¡œê¹… í”„ë¡ì‹œ
- ëŒ€ìƒ ê°ì²´ë° í•´ë‹¨ ë¡œê¹…ì„ ì¶”ê°€í•˜ëŠ” ê²½ìš°

```java
class Proxy implements ISubject {
    private RealSubject subject; 

    Proxy(RealSubject subject) {
        this.subject = subject;
    }

    public void action() {
        System.out.println("ë¡œê¹…..................");
        subject.action(); 
        System.out.println("ë¡œê¹…..................");
    }
}
```

5. ì›ê²© í”„ë¡ì‹œ
- ëŒ€ìƒê°ì²´ê°€ ì›ê²©ì„œë²„ì— ì¡´ì¬í•˜ëŠ” ê²½ìš°, ë¡œì»¬ì— í”„ë¡ì‹œ ê°ì²´ ìƒì„±í•´ **ë„¤íŠ¸ì›Œí¬ì™€ ê´€ë ¨ëœ ë¶ˆí•„ìš”í•œ ì‘ì—…**ë“¤ì„ í”„ë¡ì‹œì—ì„œ ì²˜ë¦¬í•˜ê³  ê²°ê³¼ê°’ë§Œ ë°˜í™˜í•˜ëŠ” ë°©ë²•
- í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„  í”„ë¡ì‹œë¥¼ í†µí•´ ê°ì²´ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì´ë‹ˆ ì›ê²©ì´ë“  ë¡œì»¬ì´ë“  ì‹ ê²½ ì“¸ í•„ìš”ê°€ ì—†ìœ¼ë©°, í”„ë¡ì‹œëŠ” ì§„ì§œ ê°ì²´ì™€ í†µì‹ ì„ ëŒ€ë¦¬í•˜ê²Œ ëœë‹¤.

![ì›ê²© í”„ë¡ì‹œ](/DesignPattern/images/%EC%9B%90%EA%B2%A9%ED%94%84%EB%A1%9D%EC%8B%9C.png)

> í”„ë¡ì‹œë¥¼ ìŠ¤í„°ë¸Œ, í”„ë¡ì‹œë¡œë¶€í„° ì „ë‹¬ëœ ëª…ë ¹ì–´ë¥¼ ì´í•´í•˜ê³  ì í•©í•œ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•´ì£¼ëŠ” ë³´ì¡°ê°ì²´ë¥¼ ìŠ¤ì¼ˆë ˆí†¤ì´ë¼ í•œë‹¤..



6. ìºì‹± í”„ë¡ì‹œ
- ë°ì´í„°ê°€ í° ê²½ìš°ì— ìºì‹±í•˜ì—¬ ì¬ì‚¬ìš©ì„ ìœ ë„
- í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì˜ ê²°ê³¼ë¥¼ ìºì‹œí•˜ê³  ì´ ìºì‹œì˜ ìˆ˜ëª…ì£¼ê¸°ë¥¼ ê´€ë¦¬í•œë‹¤.


```java
class Proxy implements ISubject {
    private RealSubject subject; 
    Map<String, String> data = new HashMap<>();

    Proxy(RealSubject subject) {
        this.subject = subject;
    }

    public void action(String key) {
        if(data.containsKey(key)) return data.get(key);
        String value = subject.action(); 
        data.put(key, value);

        return value;
    }
}
```


> **HTTP Proxy**
> HTTP ProxyëŠ” ì›¹ì„œë²„ì™€ ë¸Œë¼ìš°ì € ì‚¬ì´ì—ì„œ ì›¹ í˜ì´ì§€ì˜ ìºì‹±ì„ ì‹¤í–‰í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ì´ë‹¤. ì›¹ ë¸Œë¼ìš°ì €ê°€ ì–´ë–¤ ì›¹í˜ì´ì§€ë¥¼ í‘œì‹œí•  ë•Œ ì§ì ‘ ì›¹ ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, HTTP Proxyê°€ ìºì‰¬í•´ì„œ ì–´ë–¤ í˜ì´ì§€ë¥¼ ëŒ€ì‹ í•´ì„œ ì·¨ë“í•œë‹¤. ìœ íš¨ê¸°ê°„ì´ ì§€ë‚¬ë‹¤ë©´ ì›¹ ì„œë²„ì— ì›¹í˜ì´ì¦ ë‹¤ì‹œ ê°€ì§€ëŸ¬ ê°„ë‹¤.


![HTTPPRoxy](/DesignPattern/images/HTTP_Proxy.png)

## í”„ë¡ì‹œ íŒ¨í„´ íŠ¹ì§•

### í”„ë¡ì‹œ íŒ¨í„´ ì‚¬ìš©ì‹œê¸°
- ì ‘ê·¼ì„ ì œì–´í•˜ê±°ë‚˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê³  ì‹¶ì€ë°, ê¸°ì¡´ì˜ íŠ¹ì • ê°ì²´ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ëŠ” ìƒí™©
- ì´ˆê¸°í™” ì§€ì—°, ì ‘ê·¼ ì œì–´, ë¡œê¹…, ìºì‹± ë“± **ê¸°ì¡´ ê°ì²´ ë™ì‘ì— ìˆ˜ì •ì—†ì´ ê°€ë¯¸**í•˜ê³  ì‹¶ì„ ë•Œ

### í”„ë¡ì‹œ íŒ¨í„´ ì¥ì 
- **ê°œë°© íì‡„ ì›ì¹™(OCP)** ì¤€ìˆ˜ : ê¸°ì¡´ ëŒ€ìƒ ê°ì²´ì˜ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ ê°€ëŠ¥
- **ë‹¨ì¼ ì±…ì„ ì›ì¹™(SRP)** ì¤€ìˆ˜ : ëŒ€ìƒ ê°ì²´ëŠ” ìì‹ ì˜ ê¸°ëŠ¥ì—ë§Œ ì§‘ì¤‘í•˜ê³ , ê·¸ì™¸ì˜ ë¶€ê°€ ê¸°ëŠ¥ì€ í”„ë¡ì‹œê°ì²´ì— ìœ„ì„í•´ ë‹¤ì¤‘ ì±…ì„ì„ í”¼í•  ìˆ˜ ìˆë‹¤.
- ì›ë˜ì˜ ê¸°ëŠ¥ì—ë‹¤ê°€ ë¶€ê°€ì ì¸ ê¸°ëŠ¥(ë¡œê¹…, ì¸ì¦, ë„¤íŠ¸ì›Œí¬ í†µì‹  ë“±)ì„ ìˆ˜í–‰í•˜ëŠ” ë° ìš©ì´í•˜ë‹¤.
- ì‚¬ì´ì¦ˆê°€ í° ê°ì²´ê°€ ë¡œë”©ë˜ê¸° ì „ì—ë„ í”„ë¡ì‹œ ê°ì²´ë¥¼ í†µí•´ ì°¸ì¡°í•  ìˆ˜ ìˆë‹¤. 


### í”„ë¡ì‹œ íŒ¨í„´ ë‹¨ì 
- ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ í•œ ë‹¨ê³„ë¥¼ ê±°ì¹˜ê²Œ ë˜ë¯€ë¡œ, ë¹ˆë²ˆí•œ ê°ì²´ ìƒì„±ì´ í•„ìš”í•œ ê²½ìš° ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆë‹¤.
- ë¡œì§ì´ ë‚œí•´í•´ì ¸ ê°€ë…ì„±ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤.
- ë§ì€ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë„ì…í•´ì•¼í•˜ë¯€ë¡œ ì½”ë“œì˜ ë³µì¡ë„ê°€ ì¦ê°€í•œë‹¤. -> ë™ì  í”„ë¡ì‹œë¥¼ ì´ìš©í•´ í•´ê²°í•¨


## Java & Springì—ì„œì˜ Proxy
- Java
    - java.lang.reflect.Proxy
    - java.rmi.* (ì›ê²© í”„ë¡ì‹œ ëª¨ë“ˆ)
    - javax.ejb.EJBÂ 
    - javax.inject.Inject
    - javax.persistence.PersistenceContext
- Dynamic Proxy
- Spring AOP

<br>
<br>

**Ref.**
- https://inpa.tistory.com/entry/GOF-ğŸ’ -í”„ë¡ì‹œProxy-íŒ¨í„´-ì œëŒ€ë¡œ-ë°°ì›Œë³´ì?category=967431 [Inpa Dev ğŸ‘¨â€ğŸ’»:í‹°ìŠ¤í† ë¦¬]
- https://velog.io/@j3beom/%EB%94%94%EC%9E%90%EC%9D%B8-%ED%8C%A8%ED%84%B4-%ED%94%84%EB%A1%9D%EC%8B%9C-%ED%8C%A8%ED%84%B4-Proxy-Pattern