# 운영체제

- 실행할 프로그램에 필요한 자원을 할당하고, 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램
- 운영체제 또한 프로그램이므로 메모리에 적재(메모리 내 커널 영역이라는 공간에 따로 적재)
- 이외에 공간은 사용자 영역(사용자가 이용하는 응용 프로그램이 적재되는 영역)

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/f10ed93c-a773-4a75-b3c3-45a4891c3170" width="310px"/>

## 슈퍼바이저 플래그

- 커널 모드로 실행 중인지, 사용자 모드로 실행 중인지를 나타낸다.
- 1일 경우 커널모드로 실행 중, 0일 경우 사용자 모드로 실행 중임을 의미한다. (플래그 레지스터에서 확인)

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/c395d0cd-d07d-4297-a21a-c28249a4d792" width="510px"/>

운영체제는 응용 프로그램에 자원을 효율적으로 배분하고, 실행할 프로그램들이 지켜야할 규칙들을 만들어 컴퓨터 시스템 전체를 관리한다.

### 운영체제 또한 관리할 자원별로 기능이 나누어져 있다.

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/e762f8f1-dd31-4380-a467-40a353f87fa0" width="310px"/>

## 운영체제의 핵심 서비스 기능

- 자원에 접근하고 조작하는 기능
- 프로그램이 올바르고 안전하게 실행되게 하는 기능

⇒ 이러한 운영체제의 핵심 서비스를 담당하는 부분을 커널이라고한다.

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/5aec4ecb-d20c-487b-9545-847e11f36779" width="310px"/>

### 운영체제가 제공하는 서비스 중 커널에 포함되지 않는 서비스

1. 사용자 인터페이스(User Interface)

### 운영체제가 제공하는 사용자 인터페이스의 종류

1. 그래픽 유저 인터페이스(Graphic User Interface)
2. 커맨드 라인 인터페이스(Command Line Interface)

운영체제는 응용 프로그램들이 자원에 접근하려고 할 때 오직 자신을 통해서만 접근하도록 자원을 보호(문지기 역할)

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/1c354bde-1447-44c3-a14d-aa6996db6e5a" width="500px"/>
<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/eae79181-9f0a-480e-a381-e90a2e3ec395" width="500px"/>
<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/d18e096a-c1a4-4244-ae7c-5547346e1dfd" width="410px"/>

# 운영체제의 문지기 역할은 이중 모드로써 구현

## 이중 모드

- 사용자 모드
    - 운영체제 서비스를 제공받을 수 없는 실행 모드
    - 일반적인 응용 프로그램은 기본적으로 사용자 모드로 실행
    - 사용자 모드로 실행되는 일반적인 프로그램은 자원에 접근할 수 X
- 커널 모드
    - 운영체제 서비스를 제공받을 수 있는 실행 모드
    - 커널 영역의 코드를 실행할 수 있는 모드
    - CPU가 커널 모드로 명령어를 실행하면 자원에 접근하는 명령어를 비롯한 모든 명령어를 실행할 수있다.
        
        ![336](https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/8de96ad9-46d8-44e3-8545-f7307442758f)

    

# 시스템 호출(System Call)

- 사용자 모드로 실행되는 프로그램이 자원에 접근하는 운영체제 서비스르 제공받으려면 운영체제에 요청을 보내 커널 모드로 전환되어야 한다.
- 운영체제 서비스를 제공받기 위한 요청
- 소프트웨어 인터럽트(인터럽트를 발생시키는 특정 명령어에 의해 발생하는 것)
    
    ![1212](https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/31cc1ef3-ed65-441a-8df7-a5445892e013)


# 시스템 호출의 작동 예시

1. 하드 디스크에 데이터를 저장하는 시스템 호출을 발생시켜 커널 모드로 전환
2. 운영체제 내의 ‘하드 디스크에 데이터를 저장하는 코드’를 실행함으로써 접근
3. 하드 디스크에 접근이 끝났다면 다시 사용자 모드로 복귀하여 실행을 계속해 나감

![12123](https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/f8596c4d-e165-43cc-a694-0a5e83835751)

# 운영체제의 핵심 서비스

1. 프로세스 관리
    1. 실행중인 프로그램을 프로세스라고 한다.
    2. 일반적으로 하나의 CPU는 한 번에 하나의 프로세스만 실행할 수 있기에 CPU는 이 프로세스들을 조금씩 번갈아 가며 실행한다.
    3. 여러 프로세스가 동시에 실행되는 환경에서는 ‘프로세스 동기화’가 필수적이고, 프로세스가 꼼짝도 못하고 더 이상 실행되지 못하는 상황인 ‘교착 상태’를 해결해야 한다.(이부분은 뒤에서)
        
        ![12555](https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/d858e46f-b2d8-4b61-9281-217bc1db945b)

2. 자원 접근 및 할당
    1. 모든 프로세스는 자원을 필요로 함.
    2. 운영체제는 프로세스들이 사용할 자원에 접근하고, 조작함으로써 프로세스에 필요한 자원을 할당해준다. ex) CPU 스케줄링, 프로세스의 메모리 할당
3. 메모리
    1. 메모리가 이미 꽉차 있어 꼭 실행해야 할 프로세스를 적재할 공간이 없는 경우도 있고, 메모리에 공간이 남아있는 데도 불구하고 프로세스를 적재하지 못하는 상황도 발생 ⇒ 운영체제가 프로레스에게 어떻게 메모리를 할당하고, 메모리가 부족한 경우, 어떻게 극복하는지도 다룸.
4. 입출력장치
    1.  인터럽트 서비스 루틴또한 운영체제가 제공하는기능으로 커널 영역에 있음.
5. 파일 시스템 관리
    1. 컴퓨터를 사용할 때 여러 파일을 열고, 생성하고, 삭제하곤 한다. 또한 디렉터리로 관리

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/825ea91b-c4bd-4399-bc0f-6b4de3df3cd0" width="500px"/>
<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/284d7d4c-2d3d-456b-ad35-9484a69169eb" width="500px"/>
<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/5f4870c5-f6cd-4c8e-ada7-c056e3c8f59a" width="500px"/>


# 시스템 콜의 종류

1. 프로세스 컨트롤
    - 프로세스 생성 및 종료
    - 메모리에 로드, 실행
    - 프로세스 속성 값 확인, 지정
    - wait 이벤트, signal 이벤트
    - 메모리 할당
2. 파일 메니지먼트
    - 파일 생성, 파일 삭제
    - 열기, 닫기
    - 읽기, 쓰기, Reposition
    - 파일 속성 값 확인, 지정
3. 디바이스 매니지먼트
    - 디바이스 요청 및 해제
    - 읽기, 쓰기, Reposition
    - 디바이스 속성 확인, 지정
    - 비 물리적인 디바이스 해제 및 장착
4. 정보 관리
    - 시간 확인, 시간 지정
    - 시스템 데이터 확인, 지정
    - 프로세스, 파일, 디바이스 속성 가져오기
    - 프로세스, 파일, 디바이스 속성 설정하기
5. 커뮤니케이션
    - 커뮤니케이션 연결 생성 및 삭제
    - 메시지 송신, 수신
    - 상태 정보 전달
    - remote 디바이스 해제 및 장착
6. 보안
    - Permission 획득
    - Permission 설정

참고자료

- 혼자 공부하는 컴퓨터구조 + 운영체제 책 참고
- https://fjvbn2003.tistory.com/306
- https://didu-story.tistory.com/311
