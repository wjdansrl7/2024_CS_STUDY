# 프록시서버(Proxy Server)

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/483438d6-f4c9-4e88-84d3-390c9f21c545" width="500px"/>


## 프록시 서버란?

---

클라이언트와 다른 서버 간의 중계 역할을 하는 서버

서버를 통해 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해주는 컴퓨터 시스템이나 응용프로그램

# 프록시 서버의 주요 특징

- 클라이언트에겐 빠른 속도의 서비스(캐싱), 서버에게는 불필요한 부하를 줄이는 효과(로드 밸런싱)
- PC와 외부 인터넷 사이의 중계 역할
- 웹 서버는 어떤 클라이언트가 서버에 연결 요청을 하는지 알 수 없음
- 외부 인터넷의 내부 침입을 막는 방화벽과 관련이 있다.(프록시 방화벽)
- IP를 바꾸기 위한 용도로 많이 사용되고 있다.

# 프록시 서버의 종류

## 0. 전체적인 그림(Forward+Reverse Proxy)

<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/94954764-b08c-40ba-b57b-39aaf1ec79a4" width="500px"/>

## 1. ForWard proxy
<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/8384cc15-17d2-4cb2-bdd6-64dc4d9cf550" width="500px"/>


## 정의

---

클라이언트가 서버에 접근하고자 할 때, 클라이언트는 타겟 서버의 주소를 포워드 프록시에 전달하여, 포워드 프록시가 인터넷으로 요청된 내용을 가져오는 방식

ex) 클라이언트([naver.com](http://naver.com) 요청) → 포워드 프록시 서버가 naver.com 리소스를 대신 받아와 클라이언트에게 요청된 정보를 전달

## ForWard proxy의 장점

1. 클라이언트 보안
    1. 프록시 방화벽
        1. 네트워크 보안의 한 형태로, 클라이언트와 외부 서버 간의 중간자 역할
        2. 네트워크 트래픽을 직접 검사하고 필터링하여, 불법적이거나 위험한 트래픽이 내부 네트워크로 들어오는 것을 방지
        3. 각 네트워크 패킷의 내용을 분석하여 특정 애플리케이션 프로토콜(예: HTTP, FTP)에 대한 요청을 검사하고, 이를 통해 더 높은 수준의 네트워크 보안과 데이터 필터링을 제공
        4. 보안 정책에 따라 트래픽을 허용하거나 차단할 수 있으며, 사용자 인증, 콘텐츠 캐싱, 애플리케이션 프로토콜의 감시 및 제어 등 추가적인 보안 기능을 제공
    2. 프록시 방화벽 vs 일반 방화벽
        1. 작동방식
            - 프록시 방화벽은 중간자 역할을 하여 모든 네트워크 트래픽을 검사하고 필터링하는 반면, 일반 방화벽은 네트워크 경계에서 트래픽의 헤더 정보를 기반으로 필터링합니다.
        2. 보안 수준
            - 프록시 방화벽은 애플리케이션 레벨에서 트래픽을 분석하여 더 높은 수준의 보안을 제공하는 반면, 일반 방화벽은 주로 네트워크 레벨에서 기본적인 필터링을 제공합니다.
        3. 성능
            - 프록시 방화벽은 트래픽을 자세히 분석하고 처리하기 때문에 일반 방화벽보다 처리 속도가 느릴 수 있습니다.
        4. 기능성
            - 프록시 방화벽은 사용자 인증, 액세스 제어, 콘텐츠 캐싱 등 추가적인 기능을 제공할 수 있으나, 일반 방화벽은 이러한 기능이 제한적입니다.
2. 캐싱
    1. 한 번 접근한 웹 페이지 서버의 정보를 캐싱(임시보관), 이후 요청시 그대로 반환하여, 서버의 부하를 줄이는 효과
    2. ex) 4명의 클라이언트가 [naver.com](http://naver.com) 접근 → 본래는 각각 따로 인터넷을 경유해서 받지만, 포워드 프록시를 이용하면 프록시내 캐싱된 naver.com을 불러와서 훨씬 빠르게 조회
3. 암호화 - 포워드 프록시 서버를 통과할 때 암호화 → 클라이언트의 ip를 감춰주는 보안 효과(프록시 서버 IP가 보여진다)
4. 웹페이지 크롤링 속도
    1. 크롤링 속도: 분, 시간 또는 일별로 웹사이트에 요청할 수 있는 요청 수
    2. 동일한 웹 사이트에 자주 요청하는 경우 해당 웹 사이트는 귀하의 활동을 의심스러운 것으로 감지하고 귀하의 IP 주소가 콘텐츠에 액세스하지 못하도록 차단
    3. 클라이언트의 IP주소를 자주 변경함으로써 웹페이지 크롤링 속도를 피함.

일반 방화벽

일반 방화벽(또는 패킷 필터링 방화벽)은 네트워크의 입구와 출구에서 트래픽을 모니터링하고 제어하는 기본적인 방식을 사용합니다. 이 방화벽은 소스 및 목적지 IP 주소, 포트 번호, 프로토콜 타입 등의 **헤더 정보를 기반으로 패킷을 필터링합니다**. 일반 방화벽은 네트워크 레벨에서 동작하여, 설정된 규칙에 따라 트래픽을 허용하거나 차단합니다. 이 방화벽은 네트워크 보안을 제공하지만, 프록시 방화벽처럼 트래픽의 내용을 깊게 분석하지는 않습니다.

## 2. Reverse proxy
<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/447edd5d-c53a-446c-839d-01c2267417c8" width="500px"/>


## 정의

---

클라이언트는 웹서비스에 접근할 때, 웹서버에 요청하는 것이 아닌, 프록시로 요청하게 되고, 프록시가 reverse proxy 서버에서 내부에 있는 서비스 서버와 통신하여 데이터를 가져오는 방식

## **역방향 프록시 동작방식**

1. 클라이언트는 인터넷에 연결 요청을 보냅니다.
2. 클라이언트를 웹 서버에 직접 연결하는 대신 인터넷은 클라이언트의 연결 요청을 역방향 프록시로 전달합니다.
3. 역방향 프록시는 웹 서버와 통신합니다.
4. 웹 서버는 요청된 정보를 역방향 프록시에 제공합니다.
5. 원본 서버의 응답은 역방향 프록시에서 수신되어 클라이언트로 전송됩니다.

## Reverse proxy의 장점

1.  **로드 밸런싱**
    1. 역방향 프록시는 들어오는 클라이언트 트래픽을 웹 사이트 백엔드 서버 간에 균등하게 분산하여 단일 서버가 과부하되지 않도록 합니다.
        
        ex) 매초마다 많은 양의 트래픽이 수신될 가능성이 높은 서버에서 단일 원본 서버로 들어오는 트래픽을 모두 처리시 서버가 과부하되어 사용할 수 없게 됨 → 역방향 프록시는 웹 사이트 소유자가 여러 원본 서버에 걸쳐 들어오는 많은 양의 트래픽 균형을 맞추는 데 도움
        
2. 캐싱
    1. 역방향 프록시는 클라이언트가 향후 요청을 위해 자주 요청하는 데이터를 근처에 있는 서버에 캐시하는 데 도움이 됩니다. 캐싱을 사용하면 클라이언트가 콘텐츠에 더 빠르게 액세스할 수 있습니다. 정보가 필요할 때마다 동일한 웹사이트를 방문할 필요가 없습니다. 대신, 역방향 프록시는 사용자가 더 빠르게 액세스하여 재사용할 수 있도록 데이터를 검색하고 저장합니다.
3. SSL 암호화
    1. 본래 서버가 클라이언트와 통신을 할 때, TSL로 암호화, 복호화를 할 경우 비용 많이 발생 → 리버스 프록시가 SSL/TLS 연결의 종단점(endpoint)로 동작, 암호화된 요청을 받아서 복호화하고, 내부 네트워크의 서버로 요청을 전달 → 내부 네트워크로 가는 트래픽은 SSL/TLS 암호화가 필요하지 않게 됨으로써, 복잡성과 부담을 줄여줌.
4. 보안
    1. 보통 기업의 네트워크 환경은 DMZ라고 하는 내부 네트워크와 외부 네트워크 사이에 위치하는 구간이 존재하며, 이 구간에는 메일 서버, 웹 서버, FTP 서버 등 외부 서비스를 제공하는 서버가 위치하게 된다. → 해킹 시 심각한 문제 발생 → 서비스 서버는 내부망에 위치시키고 프록시 서버만 내부에 있는 서비스 서버와 통신해서 결과를 클라이언트에게 제공하는 방식으로 서비스 하게 된다.
    2. ex) 리눅스 환경에서 리버스 프록시 아파치 웹 서버를 사용한다면 SELinux를 켜놓으면 SELinux의 기본 정책이 웹 서버는 톰캣의 8080, 8009 포트만 접근할 수 있으므로 아파치 웹 서버가 해킹 당해도 웹 서버 권한으로는 내부망 연결이 불가능하다. 

## 3. 오픈 프록시(open proxy)

### 정의

---

인터넷에 연결된 모든 사용자에게 접근이 허용된 프록시 서버

자신의 실제 IP 주소를 숨기고, 지역적 제한이 있는 콘텐츠에 접근하거나, 인터넷 검열을 우회하는 등 다양한 목적으로 인터넷을 사용

### 주요 특징

1. **익명성 제공**: 사용자는 오픈 프록시를 통해 웹 서핑을 할 때 자신의 실제 IP 주소를 숨길 수 있어, 온라인에서의 익명성을 유지할 수 있습니다.
2. **콘텐츠 접근성 향상**: 특정 국가에서만 제공되는 서비스나 콘텐츠에 접근하고 싶을 때, 해당 국가에 위치한 오픈 프록시를 사용하여 지역 제한을 우회할 수 있습니다.
3. **인터넷 검열 우회**: 일부 국가나 기관에서 인터넷 사용에 제한을 두거나 특정 웹사이트에 대한 접근을 차단할 경우, 오픈 프록시를 통해 이러한 검열을 우회할 수 있습니다.

### 주의사항

- **보안 문제**: 오픈 프록시는 누구나 접근할 수 있기 때문에 악의적인 사용자에 의해 감시되거나 데이터가 탈취될 위험이 있습니다. 따라서 민감한 정보를 다루는 온라인 활동에는 사용하지 않는 것이 좋습니다.
- **속도 저하**: 많은 사용자가 동시에 오픈 프록시를 사용하면 네트워크 속도가 저하될 수 있습니다.
- **안정성 문제**: 오픈 프록시 서버는 예고 없이 서비스를 중단할 수 있으며, 서버의 안정성이 보장되지 않습니다.

## 요약

- 프록시란 원래 대리라는 의미
- 보안 분야에서는 주로 보안상의 이유 등으로 직접 통신할 수 없는 경우가 존재한다.
- 직접 통신할 수 없는 두 점 사이에서 대리로 통신을 수행하는 기능을 **프록시**, 그 중계 기능을 하는것을 **프록시 서버**라 한다.
- 시스템에 방화벽을 가지고 있는 경우 외부와의 통신을 위해 만들어 놓은 서버
- 프록시 서버는 보안 상의 목적으로 설치되는 경우가 많으나, 단순히 보안 상의 이유만으로 설치 되는 것은 아니다.
- **프록시 서버의 목적**
    - **보안**: 익명의 사용자가 서버에 접근하는 것을 막는다.
    - **속도**: Proxy 서버는 사용자의 요청을 Cahche해서 동일 요청이 들어오면 Cache 자원을 반환한다. 이는 서비스의 속도를 높여준다.
    - **ACL(access control list ACL)**: 사이트 접근에 대한 접근 정책을 정의 할 수 있다.
    - l**og/Audit**: 회사 내 직원의 인터넷 사용을 레포팅할 수 있다. 반대로 인트라넷의 사용을 레포팅할 수 도 있다.
    - 지역 네트워크의 제한 우회: 보안 상의 이유로 80 포트 외에 포트를 막아놓는 경우가 있는데 이러한 제한을 우회해서 원하는 다른 서비스를 이용할 수 있다.

## 추가

---

---

프록시 서버 사용의 위험

- 암호화 부재 - 대부분의 프록시는 트래픽을 암호화하지 않으므로 프록시는 사용자를 인터넷 활동을 훔쳐보는 사람들(인터넷 서비스 제공 업체 등)로부터 보호할 수 없습니다. 또한 일반적으로 사용자의 IP 주소가 보호되지 않습니다.
- 검색 데이터 수집 가능성 - 프라이버시 때문에 프록시를 사용하는 것이라면, 프록시 서버 보다는 다른 방법이 개인정보 보호에 더 효과적입니다. 프록시는 일반적으로 IP 주소 유출 방지를 보장하지 않기 때문에 웹사이트가 사용자의 연결 위치를 파악할 수 있습니다.
- 포트 해킹 위험 - 일부 프록시는 보안상의 책임이 있는 열린 포트를 사용합니다. 가장 자주 사용되고 해킹된 개방형 포트 중에는 FTP, DNS, HTTP, HTTPS가 있습니다. 열려 있거나 암호로 보호되지 않은 경우 해커가 들어올 수 있도록 입구를 열어 둡니다.
- 속도 변동에 취약 - 특히 공개 프록시의 경우, 업계에서 알려진 문제인 많은 사용자와 사용자의 요청으로 인해 프록시의 속도가 빠르지 못합니다.
<img src="https://github.com/wjdansrl7/2024_CS_STUDY/assets/48114924/5480a6d4-72c9-4390-9975-417e828fabc1" width="500px"/>


VPN(Virtual Private Network, 가상 사설망)

- 프록시 서버와 마찬가지로 원격 서버를 통해 인터넷 트래픽을 재라우팅하고 실제 [IP](https://nordvpn.com/ko/what-is-my-ip/) 주소를 가상 IP 주소로 대체함으로써 웹사이트 측에서 사용자의 실제 IP 주소와 위치를 확인할 수 없도록 합니다.

하지만 프록시 서버와 달리 VPN은 운영 체제 수준에서 동작하므로 브라우저나 백그라운드 앱에서 발생하는 모든 트래픽을 리디렉션할 수 있다는 차이점이 있습니다.

VPN을 이용하면 [Windows](https://nordvpn.com/ko/download/windows/), Chrome을 포함한 다양한 플랫폼에서 인터넷과 기기 사이의 트래픽을 암호화할 수 있으며 인터넷 업체가 사용자의 온라인 활동을 확인할 수 없도록 할 수 있습니다. 또한 VPN을 사용하면 정부 감시를 회피하고 [사이버 범죄](https://nordvpn.com/ko/cybercrimes/)와 해킹 공격을 방지할 수 있으며 온라인 프라이버시와 보안도 확보할 수 있습니다.

하지만 다수의 무료 VPN과 프록시 서비스가 IP 주소, DNS 요청과 같은 사용자의 중요 정보를 기록하고 있습니다. 또한 이러한 서비스 중 일부는 사용자의 중요 정보를 사법당국에 제공하거나, 광고 업체에 판매하는 경우가 있으며, 해킹으로 인해 정보가 유출되는 경우도 있습니다.

따라서 VPN을 선택할 때에는 [엄격한 노로그 정책](https://nordvpn.com/ko/features/strict-no-logs-policy/)을 준수하는 서비스를 이용해야 한다는 것을 기억해 주세요.

VPN과 프록시 공통점

- 프록시 서버와 VPN 모두 원격 서버를 통해 트래픽을 재라우팅하고 실제 IP를 가상 IP로 대체한다는 점에서 유사한 서비스라고 할 수 있습니다.

VPN과 프록시 차이점

- 프록시 서버와 달리 VPN은 [트래픽 자체를 안전하게 암호화합니다](https://nordvpn.com/ko/features/next-generation-encryption/). VPN을 사용하면 인터넷 업체의 추적과 정부의 감시를 피하고 해킹 공격을 방지할 수 있습니다. 반면에 프록시 서버는 트래픽을 완벽히 암호화할 수 없으므로 중요 정보를 관리할 때는 적합하지 않은 서비스입니다.
- VPN은 운영 체제 수준에서 동작해 모든 트래픽을 라우팅합니다. 반면에 프록시 서버는 응용프로그램 수준에서 동작하며 특정 앱 또는 브라우저의 트래픽만 라우팅할 수 있습니다. 이러한 웹 프록시 또는 프록시 사이트는 해당 브라우저에서 벗어나 활동하는 내용은 보호하지 못합니다.
- VPN에서는 데이터가 암호화되기 때문에 프록시 서버보다 연결 속도가 느릴 수 있습니다. 하지만 [인터넷 연결 및 검색 속도를 개선할 수 있는 방법](https://nordvpn.com/ko/blog/does-a-vpn-slow-down-your-internet/)이 있으며 빠른 연결 속도를 제공하는 서비스도 다수 존재합니다.
- 많은 프록시 서버는 무료로 제공되지만 VPN 서비스는 일반적으로 유료입니다. 무료 VPN의 경우 데이터 사용량이 제한되고 사용자 정보를 무단으로 수집하는 경우도 존재하므로 무료 VPN 서비스의 신뢰성은 낮은 편입니다.
- 프록시 서버에서는 연결 중단이 자주 발생하는 반면 VPN 서버의 연결은 상대적으로 안정적입니다.

VPN의 성능이 프록시 서버보다 우수한가? O

VPN은 보안 VPN 서버를 통해서 트래픽을 라우팅하고 트래픽을 암호화함으로써 프라이버시와 보안을 강화하기 때문입니다. 프록시 서버는 트래픽을 중개 서버로 통과시키기만 할 뿐 추가적인 보안을 제공하지 않습니다.

또한 VPN은 운영 체제 수준에서 동작하면서 모든 트래픽을 보호할 수 있기에 VPN의 성능이 프록시 서버보다 더 우수하다고 할 수 있습니다.

참고자료

[https://nordvpn.com/ko/blog/proxy-versus-vpn/](https://nordvpn.com/ko/blog/proxy-versus-vpn/)

[https://velog.io/@jangwonyoon/Proxy-Server프록시-서버란](https://velog.io/@jangwonyoon/Proxy-Server%ED%94%84%EB%A1%9D%EC%8B%9C-%EC%84%9C%EB%B2%84%EB%9E%80)

[https://research.aimultiple.com/forward-vs-reverse-proxy/](https://research.aimultiple.com/forward-vs-reverse-proxy/)

[https://inpa.tistory.com/entry/NETWORK-📡-Reverse-Proxy-Forward-Proxy-정의-차이-정리](https://inpa.tistory.com/entry/NETWORK-%F0%9F%93%A1-Reverse-Proxy-Forward-Proxy-%EC%A0%95%EC%9D%98-%EC%B0%A8%EC%9D%B4-%EC%A0%95%EB%A6%AC)
